# General configuration

[general.jira]
instance_url = "https://issues.redhat.com"  # JIRA instance URL
project = "CLE"  # Name of the project to sync tickets to
token = "$secrets.jira_token"  # API token to use for authentication
default_issue_type = "Story"  # Issue type to use when creating new issue in JIRA
label = "jira_sync"  # Label used for all issues created by this script
story_points_field = "customfield_12310243" # JIRA issue field used for story points (this could be custom field)
external_url_field = "customfield_12317242" # JIRA field used for external URL (this is used to match the JIRA issue with upstream issue)
blocked_field = "customfield_12316543" # JIRA issue field used for marking ticket as blocked

# Map the boolean values to JIRA field values
[general.jira.blocked_values]
true = 14656
false = 14657

# Map the ticket state to JIRA project state
# Recognizable states are:
# * new = ticket is open and nobody is assigned to it
# * assigned = ticket is assigned to user
# * blocked = ticket is blocked (see blocked_label in corresponding section)
# * closed = ticket is closed
[general.jira.statuses]
new = "New"
assigned = "In Progress"
blocked = "In Progress"
closed = "Closed"


# Pagure configuration
[instances."pagure.io"]
type = "pagure"
enabled = true  # Enable/Disable Pagure instance
instance_url = "https://pagure.io/"  # URL for pagure endpoint
blocked_label = "blocked"  # Label that is marking blocked issues
usermap = "pagureio_jira_usermap.toml"  # Map pagure.io to JIRA users
# converts specific label to story point
labels_to_story_points = { low-trouble = 1, medium-trouble = 5, high-trouble = 10 }
# retrieve also closed tickets that were closed in last X days
# if set to 0, only retrieves open tickets
retrieve_closed_days_ago = 3

[[instances."pagure.io".query_repositories]]
namespace = "fedora-infra"
label = "cle"  # Label marking issues to be synchronized

[instances."pagure.io".repositories]
# List of repositories to check for tickets
# When label is set, only tickets with this label will be covered
"fedora_nightlies" = {}
"Fedora-Council/council-docs" = {}
"Fedora-Council/tickets" = {}
"fedora-docs" = {}
"fedora-docs/quick-docs" = {}
"fedora-easy-karma" = {}
"fedora-infrastructure" = {}
"fedora-infra/ansible" = {enabled = false}  # The Ansible repo doesnâ€™t have issues
"fedora-infra/arc" = {}
"fedora-infra/infrastructure-projects" = {}
"fedora-pdr" = {}
"fedora-qa" = {}
"fedora-qa/blockerbugs" = {}
"fedora-qa/check-compose" = {}
"fedora-qa/createhdds" = {}
"fedora-qa/fedora_openqa" = {}
"fedora-qa/os-autoinst-distri-fedora" = {}
"fedora-qa/qa-docs" = {}
"fedora-qa/qa-misc" = {}
"fedora-qa/qa-stats" = {}
"fedora-qa/relval" = {}
"fedora-qa/relvalconsumer" = {}
"fedora-qa/testdays-web" = {}
"releng" = {}

# GitHub configuration
[instances."github.com"]
type = "github"
enabled = true
instance_url = "https://github.com"
instance_api_url = "https://api.github.com"
token = "$secrets.githubcom_token"
label = "cle"
blocked_label = "blocked"
usermap = "githubcom_jira_usermap.toml"
# retrieve also closed tickets that were closed in last X days
# if set to 0, only retrieves open tickets
retrieve_closed_days_ago = 3

[[instances."github.com".query_repositories]]
org = "fedora-infra"

[[instances."github.com".query_repositories]]
org = "CentOS"

[instances."github.com".repositories]
"neoave/mrack" = {}
"os-autoinst/openQA-python-client" = {}
"temtee/tmt" = {}
"Zlopez/jira_sync" = { label = "cle" }

# GitLab configuration
[instances."gitlab.com"]
type = "gitlab"
enabled = true
instance_url = "https://gitlab.com"
instance_api_url = "https://gitlab.com/api/v4"
token = "$secrets.gitlabcom_token"
blocked_label = "blocked"
usermap = "gitlabcom_jira_usermap.toml"
labels_to_story_points = { low-trouble = 1, medium-trouble = 5, high-trouble = 10 }
# retrieve also closed tickets that were closed in last X days
# if set to 0, only retrieves open tickets
retrieve_closed_days_ago = 3

[[instances."gitlab.com".query_repositories]]
org = "fedora/design"
label = "cle"

[[instances."gitlab.com".query_repositories]]
org = "fedora/docs"
label = "cle"

[instances."gitlab.com".repositories]
"CentOS/infra/tracker" = { blocked_label = "status::blocked" }
"fedora/legal/fedora-legal-docs" = {}

# Forgejo configuration for codeberg.org
[instances."codeberg.org"]
type = "forgejo"
enabled = true
instance_url = "https://codeberg.org"
# instance_api_url = "https://codeberg.org/api/v1"
token = "$secrets.codebergorg_token"
blocked_label = "blocked"
usermap = "codebergorg_jira_usermap.toml"
labels_to_story_points = { low-trouble = 1, medium-trouble = 5, high-trouble = 10 }
# retrieve also closed tickets that were closed in last X days
# if set to 0, only retrieves open tickets
retrieve_closed_days_ago = 3

[[instances."codeberg.org".query_repositories]]
org = "fedora"
label = "cle"

[instances."codeberg.org".repositories]
"AdamWill/rmdepcheck" = {}

# Forgejo configuration for codeberg.org
[instances."forge.fedoraproject.org"]
type = "forgejo"
enabled = true
instance_url = "https://forge.fedoraproject.org"
token = "$secrets.forgefedoraprojectorg_token"
blocked_label = "blocked"
usermap = "pagureio_jira_usermap.toml"
labels_to_story_points = { low-trouble = 1, medium-trouble = 5, high-trouble = 10 }
# retrieve also closed tickets that were closed in last X days
# if set to 0, only retrieves open tickets
retrieve_closed_days_ago = 3

# Commenting this out because of https://forge.fedoraproject.org/forge/forge/issues/304
#[[instances."forge.fedoraproject.org".query_repositories]]
#org = "cle"
#label = "cle"

[instances."forge.fedoraproject.org".repositories]
"forge/forge" = {}
